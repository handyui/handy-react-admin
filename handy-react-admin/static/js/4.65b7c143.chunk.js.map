{"version":3,"sources":["../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","utils/dateUtil.ts","api/file.ts","components/upload/utils.ts","webpack:///./src/components/upload/index.scss?9a6c","components/upload/SingleUpload.tsx","components/upload/AvatarUpload.tsx","components/upload/index.ts","components/upload/index.scss","api/placeInfo.ts","pages/placeInfo/formInfo.tsx","pages/placeInfo/allDetail.tsx"],"names":["_objectWithoutProperties","source","excluded","key","i","target","Object","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","DATE_TIME_FORMAT","DATE_FORMAT","formatToDateTime","date","moment","format","formatToDate","uploadAttachFile","data","request","post","getAttachFile","id","get","now","Date","index","options","locals","SingleUpload","forwardRef","props","ref","accept","multiple","fileList","ownerId","disable","useState","loading","state","setState","ids","setIds","Map","imgUrl","setImgUrl","previewVisible","previewTitle","previewImage","showImg","setShowImg","getImg","a","res","b","Blob","url","URL","createObjectURL","set","getAsyncData","forEach","item","setTimeout","useEffect","handleDelete","console","log","deleteAttachFile","then","code","message","idIndex","findIndex","arrs","splice","nIds","Message","success","error","useImperativeHandle","getfileIds","arr","map","push","setfileList","className","tip","spinning","status","onClick","onPreview","imageUrl","src","alt","style","width","type","size","fileName","link","document","createElement","download","href","click","handleDownload","tabIndex","role","onChange","e","files","nextFileList","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","uid","name","formData","FormData","append","val","targetItem","filter","PlusOutlined","marginTop","visible","title","footer","onCancel","defaultProps","fileId","classes","classNames","uploadClasses","module","exports","deletePlace","deletePlaces","getPlace","getPlacePage","savePlace","FormInfoPage","getContext","useContext","Context","modalType","resData","veteransId","formRef","useRef","uploadRef","addSchema","layout","labelCol","span","wrapperCol","grid","rowGutter","colSpan","formItem","label","field","value","placeholder","undefined","treeDefaultExpandAll","asyncOptions","curValue","fields","getOrganizationTtree","mapTree","getDictionaryOption","tailLayout","render","validateForm","setFields","veteransBaseInfo","current","dynamicValidateForm","React","createContext","DetailPage","history","useHistory","location","useLocation","panes","useSelector","layoutReducer","dispatch","useDispatch","isLoading","setLoading","detailType","setResult","setFileList","setVeteransId","_isCancelled","getDetail","placeId","birthDate","termValidityEnd","termValidityStart","setFieldsValue","getDatas","pathname","split","slice","join","matchPath","path","exact","checkUrls","params","refresh","handleClose","menuPath","setPanes","deletePane","handleSubmit","validateFields","actualAddress","domicile","educationDegree","fixedTelephone","health","householdAddress","householdAddressType","householdType","idCardNo","idPhoto","maritalStatus","nameUsedBefore","nation","organizationId","phone","politicalIdentity","remarks","sex","signingIssuingOrganization","wechatQq","whetherHk","fileIds","houseType","mainDemands","mainDifficulties","medicalInsurance","pensionBenefits","personnelType","rest","version","toString","veteransBaseInfoAddReq","close","forceUpdate","Provider"],"mappings":"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","file":"static/js/4.65b7c143.chunk.js","sourcesContent":["import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","import { isObject, isString } from './is'\nimport moment from 'moment';\n\nconst DATE_TIME_FORMAT = 'YYYY-MM-DD HH:mm:ss';\nconst DATE_FORMAT = 'YYYY-MM-DD';\n\nexport function formatToDateTime(date: moment.MomentInput = null): string {\n  return moment(date).format(DATE_TIME_FORMAT);\n}\n\nexport function formatToDate(date: moment.MomentInput = null): string {\n  return moment(date).format(DATE_FORMAT);\n}\n\nexport const formatAgo = (str: string | number) => {\n  if (!str) return '';\n  const date = new Date(Number(str));\n  const time = new Date().getTime() - date.getTime(); // 现在的时间-传入的时间 = 相差的时间（单位 = 毫秒）\n  if (time < 0) {\n    return '';\n  } else if (time / 1000 < 30) {\n    return '刚刚';\n  } else if (time / 1000 < 60) {\n    return parseInt(String(time / 1000)) + '秒前';\n  } else if (time / 60000 < 60) {\n    return parseInt(String(time / 60000)) + '分钟前';\n  } else if (time / 3600000 < 24) {\n    return parseInt(String(time / 3600000)) + '小时前';\n  } else if (time / 86400000 < 31) {\n    return parseInt(String(time / 86400000)) + '天前';\n  } else if (time / 2592000000 < 12) {\n    return parseInt(String(time / 2592000000)) + '月前';\n  } else {\n    return parseInt(String(time / 31536000000)) + '年前';\n  }\n};\n/**\n * @description: 格式化请求参数时间\n */\nexport function formatRequestDate(params: any) {\n  for (const key in params) {\n    if (params[key] && params[key]._isAMomentObject) {\n      params[key] = params[key].format(DATE_TIME_FORMAT);\n    }\n    if (isString(key)) {\n      const value = params[key];\n      if (value) {\n        try {\n          params[key] = isString(value) ? value.trim() : value;\n        } catch (error) {\n          throw new Error(error);\n        }\n      }\n    }\n    if (isObject(params[key])) {\n      formatRequestDate(params[key]);\n    }\n  }\n}\n\nexport const dateUtil = moment;\n","import { request } from '@/utils/api.request'\r\n\r\n/**-------------------------------附件相关------------------------------- */\r\n/* 文件上传 \r\nfile:file\r\nfileType: 附件类型编码，字典code\r\ncontent type:\r\n*/\r\nexport const uploadAttachFile = (data:object) => request.post('/attachFile/upload', data)\r\n\r\n// 删除附件\r\nexport const deleteAttachFile = (id:string) => request.get(`/attachFile/delete/${id}`)\r\n\r\n// 文件下载\r\nexport const getAttachFile = (id:string) => request.get(`/attachFile/get/${id}`, {}, {'Content-Type': 'application/octet-stream'}, 'arraybuffer')\r\n\r\n// 根据owner获取附件列表\r\nexport const getAttachFileByOwner = (data:object) => request.post('/attachFile/listByOwner', data)\r\n\r\n\r\n","const now = +new Date();\r\nlet index = 0;\r\n\r\nexport const getUid=()=> {\r\n  // eslint-disable-next-line no-plusplus\r\n  return `upload-${now}-${++index}`;\r\n}\r\n\r\nexport function getFileItem(file:any, fileList: any[]) {\r\n  const matchKey = file.uid !== undefined ? 'uid' : 'name';\r\n  return fileList.filter(item => item[matchKey] === file[matchKey])[0];\r\n}","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React, { useEffect,forwardRef, useImperativeHandle, useState} from 'react'\r\n// import { UploadProps, UploadProgressEvent, UploadRequestError, RcFile, Action } from './interface'\r\nimport {uploadAttachFile, getAttachFile, deleteAttachFile} from '@/api/file'\r\n// import RcUpload  from 'rc-upload'\r\n// import { FormInstance } from 'antd/lib/form'\r\n;import{ PlusOutlined } from '@ant-design/icons'\r\nimport { Button, Spin, message as Message, Modal } from 'antd'\r\nimport { getUid } from './utils'\r\nimport './index.scss'\r\n// import axios from 'axios'\r\n\r\nexport type UploadFileStatus = 'error' | 'success' | 'done' | 'uploading' | 'removed'\r\n\r\nexport interface UploadFile<T = any> {\r\n    uid?: string;\r\n    size?: number;\r\n    name?: string;\r\n    fileName?: string;\r\n    lastModified?: number;\r\n    lastModifiedDate?: Date;\r\n    filePath?: string;\r\n    status?:  string;\r\n    percent?: number;\r\n    fileThumPath?: string;\r\n    originFileObj?: File | Blob;\r\n    response?: T;\r\n    error?: any;\r\n    linkProps?: any;\r\n    type?: string;\r\n    xhr?: T;\r\n    preview?: string;\r\n}\r\n\r\ninterface SingleUploadProps<T = any>{\r\n    children?:any\r\n    accept?:any\r\n    multiple?:boolean\r\n    fileList?: UploadFile<T>[]\r\n    // type: string\r\n    // color?: string\r\n    // size?: number|string\r\n    // callback?:()=>void\r\n    // callback?:(val:any)=>void\r\n    ownerId?:string\r\n    // ref?:any\r\n    disable?: boolean\r\n    className?: string\r\n}\r\n\r\nfunction getBase64(img:any, callback:(val:any)=>void) {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result));\r\n    reader.readAsDataURL(img)\r\n}\r\n\r\nconst SingleUpload= forwardRef<any, SingleUploadProps>((props, ref) => {\r\n    const {accept, multiple, fileList, ownerId, disable}:any = props\r\n    const [state, setState] = useState({\r\n        fileList: [] as any ,\r\n        loading: false,\r\n    })\r\n    const [ids, setIds] = useState([] as any)\r\n    const [imgUrl, setImgUrl] = useState(new Map() as any)\r\n\r\n    const [showImg, setShowImg] = useState({\r\n        previewVisible:false,\r\n        previewTitle:'',\r\n        previewImage: ''\r\n    })\r\n\r\n    const getImg=async(id:string)=>{\r\n        let res:any = await getAttachFile(id)\r\n        let b = new Blob([res])\r\n        let url = URL.createObjectURL(b) // 创建指向参数b的URL\r\n        setImgUrl(imgUrl.set(id, url))\r\n        return url\r\n    }\r\n\r\n    const getAsyncData = (fileList:any) => {\r\n        // console.log('fileList', fileList)\r\n        fileList &&  fileList.forEach(async(item:any)=>{\r\n            // await getImg(item.id)\r\n            item['imageUrl'] = await getImg(item.id)\r\n            item['fileType'] = 'ddddd'\r\n        })\r\n        setTimeout(()=>{\r\n            setState({\r\n                fileList: fileList && [...fileList],\r\n                loading: false\r\n            })\r\n        }, 500)\r\n      }\r\n\r\n    useEffect(()=>{\r\n        getAsyncData(fileList)\r\n    }, [fileList])\r\n\r\n    const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { files }:any = e.target\r\n        if(files.length !==0){\r\n            const nextFileList = state.fileList\r\n            files[0]['uid'] = getUid()\r\n            files[0]['status'] = 'uploading'\r\n            \r\n            // 生成base64缩略图\r\n            getBase64(files[0], imageUrl => {\r\n                const fileIndex = nextFileList.findIndex((uid:string) => uid === files[0].uid)\r\n                if (fileIndex === -1) {\r\n                    nextFileList.push({ uid:files[0].uid, imageUrl, id:'', fileName: files[0].name, status: 'uploading'});\r\n                }\r\n                setState({\r\n                    fileList: [...nextFileList],\r\n                    loading: true\r\n                })\r\n                // 提交\r\n                const formData = new FormData() // FormData 对象\r\n                formData.append('file', files[0]) // 文件对象\r\n                formData.append('fileType', '') // 附件类型编码，字典code\r\n                formData.append('ownerId', ownerId) // 文件对象\r\n                uploadAttachFile(formData).then((val)=>{\r\n                    const {code, result}:any = val\r\n                    if(code===200){\r\n                        const targetItem = nextFileList.filter((item:any) => item['uid'] === files[0].uid)[0]\r\n                        targetItem['id'] = result.id\r\n                        targetItem['status'] = 'done'\r\n                        // setTimeout(()=>{\r\n                            setState({  \r\n                                fileList: [...nextFileList],\r\n                                loading: false\r\n                            })\r\n                            setIds(\r\n                                [...ids, result.id] \r\n                            )\r\n                            // callback&&callback([...ids, result.id] )\r\n                        // }, 200)\r\n                    }else{\r\n                        const targetItem = nextFileList.filter((item:any) => item['fileName'] === result.fileName)[0]\r\n                        targetItem['id'] = result.id\r\n                        targetItem['status'] = 'error'\r\n                        setState({\r\n                            fileList: [...state.fileList],\r\n                            loading: false\r\n                        })\r\n                    }\r\n                })\r\n\r\n            })\r\n        }\r\n    }\r\n\r\n    const handleDownload=(item:any)=>{\r\n        const {id, fileName } = item\r\n        // console.log('id1', id)\r\n        getAttachFile(id)\r\n        //  axios.get(`http://192.168.7.221:8080/attachFile/get/${id}`, {\r\n        // // axios.get(`http://localhost:3001/attachFile/get/2db5e4a034311ea772efd6f7db4b28ae`, {\r\n        //     headers: {\r\n        //       'Content-Type': 'application/octet-stream',\r\n        //       'token':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJvcmdhbml6YXRpb25JZCI6IjAwMSIsInJvbGVJZCI6IjEsMiIsInVzZXJOYW1lIjoiYWRtaW4iLCJleHAiOjE2MDk3OTcyNjAsInVzZXJJZCI6IjEiLCJhY2NvdW50IjoiYWRtaW4ifQ.vdEJKDqwRB1xOoypxbK8GOelu-M8R_6oqkCeUGqttpw'\r\n        //     },\r\n        //     responseType: 'arraybuffer',})\r\n        .then((res:any) => {\r\n            var b = new Blob([res])\r\n            var url = URL.createObjectURL(b) // 创建指向参数b的URL\r\n            var link = document.createElement('a')\r\n            // 设置导出的文件名\r\n            link.download = fileName\r\n            link.href = url\r\n            // 点击获取文件\r\n            link.click();\r\n        })\r\n    }\r\n\r\n    const handleDelete=(id:any)=>{\r\n        console.log('id2', id)\r\n        setState({  \r\n            fileList: [...state.fileList],\r\n            loading: false\r\n        })\r\n        deleteAttachFile(id).then(res=>{\r\n            const {code, message}:any = res\r\n            if(code === 200){\r\n                var idIndex = state.fileList.findIndex((item:any, index:number) => {\r\n                    return item.id === id\r\n                })\r\n                const arrs= state.fileList\r\n                arrs.splice(idIndex, 1)\r\n                setState({\r\n                    fileList: arrs,\r\n                    loading: false\r\n                })\r\n\r\n                var i = ids.findIndex((item:any, index:number) => {\r\n                    return item === id\r\n                })\r\n                const nIds = ids\r\n                nIds.splice(i, 1)\r\n                setIds(\r\n                    [...nIds] \r\n                )\r\n                // callback&&callback([...nIds])\r\n                Message.success(message)\r\n            }else{\r\n                Message.error(message)\r\n            }\r\n        })\r\n    }\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        getfileIds: () => {\r\n            let arr:string[] = []\r\n           state.fileList.map((item:any)=>(\r\n                arr.push(item.id)\r\n            ))\r\n           return arr\r\n        },\r\n        setfileList:(fileList:any[])=> getAsyncData(fileList)\r\n    }))\r\n\r\n    const onCancel=()=>{\r\n        setShowImg({\r\n            previewVisible: false,\r\n            previewTitle:'',\r\n            previewImage: ''\r\n        })\r\n    }\r\n\r\n    const onPreview=(imgUrl:string)=>{\r\n        setShowImg({\r\n            previewVisible: true,\r\n            previewTitle:'',\r\n            previewImage: imgUrl\r\n        })\r\n    }\r\n\r\n    return (\r\n        <>\r\n        <div className=\"upload-list\" ref={ref}>\r\n          {\r\n            state.fileList && state.fileList.length>0 && state.fileList.map((item:any,index:number)=>\r\n                  <div key={index} className=\"upload-list-item\">\r\n                      <Spin tip=\"Loading...\" spinning={item.status === 'uploading'}>\r\n                        <div className=\"upload-list-item-info\" onClick={()=> onPreview(item.imageUrl)}>\r\n                            <img src={item.imageUrl} alt=\"avatar\" style={{ width: '100%' }} />\r\n                            \r\n                        </div>\r\n                        {!disable? <div className=\"upload-list-item-actions\">\r\n                            <Button type=\"link\" size=\"small\" onClick={()=>handleDownload(item)}>下载</Button>\r\n                            <Button type=\"link\" size=\"small\" onClick={()=>handleDelete(item.id)}>删除</Button>\r\n                        </div>:''}\r\n                      </Spin>\r\n                  </div>\r\n              )\r\n          }\r\n          {\r\n            (!state.loading && !disable)?  <div className=\"upload-list-item-info upload-select\">\r\n              <span tabIndex={0} className=\"upload\" role=\"button\">\r\n                  {/* <input type=\"file\" ref={ref} onChange={onChange} className=\"upload-input\"   accept={accept} multiple={multiple}\r\n                  style={{display: \"none\"}}\r\n                   onClick={e => e.stopPropagation()}/> */}\r\n                   <input type=\"file\" onChange={onChange} multiple={multiple} accept={accept}></input>\r\n                  <div>\r\n                      <PlusOutlined />\r\n                      <div style={{marginTop: '8px'}}>上传</div>\r\n                  </div>\r\n              </span>\r\n          </div> :''\r\n          }\r\n        </div>\r\n\r\n        <Modal\r\n          visible={showImg.previewVisible}\r\n          title={showImg.previewTitle}\r\n          footer={null}\r\n          onCancel={onCancel}\r\n        >\r\n          <img alt=\"example\" style={{ width: '100%' }} src={showImg.previewImage} />\r\n        </Modal>\r\n        </>\r\n    )\r\n})\r\n\r\nSingleUpload.defaultProps = {\r\n    multiple: false,\r\n    disable: false\r\n}\r\n\r\nexport default SingleUpload\r\n","import React, { useEffect, forwardRef, useImperativeHandle, useState} from 'react'\r\n// import { UploadProps, UploadProgressEvent, UploadRequestError, RcFile, Action } from './interface'\r\nimport {uploadAttachFile, getAttachFile} from '@/api/file'\r\nimport classNames from 'classnames'\r\n// import RcUpload  from 'rc-upload'\r\n// import { FormInstance } from 'antd/lib/form'\r\n;import{ PlusOutlined } from '@ant-design/icons'\r\nimport { Spin } from 'antd'\r\n// import { getUid, getFileItem } from './utils'\r\nimport './index.scss'\r\n// import axios from 'axios'\r\n\r\nexport type UploadFileStatus = 'error' | 'success' | 'done' | 'uploading' | 'removed'\r\n\r\nexport interface UploadFile<T = any> {\r\n    uid?: string;\r\n    size?: number;\r\n    name?: string;\r\n    fileName?: string;\r\n    lastModified?: number;\r\n    lastModifiedDate?: Date;\r\n    filePath?: string;\r\n    status?:  string;\r\n    percent?: number;\r\n    fileThumPath?: string;\r\n    originFileObj?: File | Blob;\r\n    response?: T;\r\n    error?: any;\r\n    linkProps?: any;\r\n    type?: string;\r\n    xhr?: T;\r\n    preview?: string;\r\n}\r\n\r\ninterface SingleUploadProps<T = any>{\r\n    children?:any\r\n    accept?:any\r\n    multiple?:boolean\r\n    fileId?: string\r\n    // type: string\r\n    // color?: string\r\n    // size?: number|string\r\n    // callback?:()=>void\r\n    // callback?:(val:any)=>void\r\n    ownerId?:string\r\n    // ref?:any\r\n    disable?: boolean\r\n    className?: string\r\n}\r\n\r\n\r\nfunction getBase64(img:any, callback:(val:any)=>void) {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result));\r\n    reader.readAsDataURL(img)\r\n}\r\n\r\nconst SingleUpload= forwardRef<any, SingleUploadProps>((props, ref) => {\r\n    const {accept, multiple, fileId, ownerId, className}:any = props\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const [nextFileList, setNextFileList] = useState([] as any[])\r\n    const [state, setState] = useState({\r\n        imageUrl:'', \r\n        id:'', \r\n        fileName: '', \r\n        status: 'done'\r\n    })\r\n    const [imgUrl, setImgUrl] = useState(new Map() as any)\r\n\r\n    const getImg=async(id:string)=>{\r\n        let res:any = await getAttachFile(id)\r\n        let b = new Blob([res])\r\n        let url = URL.createObjectURL(b) // 创建指向参数b的URL\r\n        setImgUrl(imgUrl.set(id, url))\r\n        return url\r\n    }\r\n\r\n    const getAsyncData = async(id:string) => {\r\n        console.log('getAsyncDatassss', fileId)\r\n        let imageUrl = await getImg(id)\r\n        setState({\r\n            imageUrl, \r\n            id, \r\n            fileName: '', \r\n            status: 'done'\r\n        })\r\n      }\r\n\r\n    useEffect(()=>{\r\n        console.log('fileId', fileId)\r\n        getAsyncData(fileId)\r\n    }, [fileId])\r\n\r\n    const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { files }:any = e.target\r\n        if(files.length !==0){\r\n            // setState({  \r\n            //     imageUrl:'', \r\n            //     id:'', \r\n            //     fileName: files[0].name, \r\n            //     status: 'uploading'\r\n            // })\r\n            // 生成base64缩略图\r\n            getBase64(files[0], imageUrl => {\r\n                nextFileList.push({ imageUrl, id:'', fileName: files[0].name, status: 'uploading'});\r\n                setState({\r\n                    imageUrl, \r\n                    id:'', \r\n                    fileName: files[0].name, \r\n                    status: 'uploading'\r\n                })\r\n                // 提交\r\n                const formData = new FormData() // FormData 对象\r\n                formData.append('file', files[0]) // 文件对象\r\n                formData.append('fileType', '') // 附件类型编码，字典code\r\n                formData.append('ownerId', ownerId) // 文件对象\r\n                uploadAttachFile(formData).then((val)=>{\r\n                    const {code, result}:any = val\r\n                    if(code===200){\r\n                            setState({  \r\n                                imageUrl, \r\n                                id: result.id, \r\n                                fileName: files[0].name, \r\n                                status: 'done'\r\n                            })\r\n                    }else{\r\n                        setState({  \r\n                            imageUrl, \r\n                            id: result.id, \r\n                            fileName: files[0].name, \r\n                            status: 'error'\r\n                        })\r\n                    }\r\n                })\r\n\r\n            })\r\n        }\r\n    }\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        getfileIds: () => {\r\n           console.log('arr', state.id)\r\n           return state.id\r\n        },\r\n        setfileList:(fileId:string)=> getAsyncData(fileId)\r\n    }))\r\n\r\n    const classes = classNames('upload-list avatar-upload', className)\r\n\r\n    const uploadClasses = classNames('upload-list-item-info upload-select', {\r\n        'avatar-upload-select': state.imageUrl\r\n    })\r\n    \r\n\r\n    return (\r\n        <>\r\n        <div className={classes} ref={ref}>\r\n          {\r\n            state.imageUrl && \r\n                <div className=\"upload-list-item\">\r\n                    <Spin tip=\"Loading...\" spinning={state.status === 'uploading'}>\r\n                    <div className=\"upload-list-item-info\" >\r\n                        <img src={state.imageUrl} alt=\"avatar\" style={{ width: '100%' }} />\r\n                    </div>\r\n                    </Spin>\r\n                </div>\r\n           \r\n          }\r\n          {\r\n            <div className={uploadClasses} >\r\n              <span tabIndex={0} className=\"upload\" role=\"button\">\r\n                  {/* <input type=\"file\" ref={ref} onChange={onChange} className=\"upload-input\"   accept={accept} multiple={multiple}\r\n                  style={{display: \"none\"}}\r\n                   onClick={e => e.stopPropagation()}/> */}\r\n                   <input type=\"file\" onChange={onChange} multiple={multiple} accept={accept}></input>\r\n                  <div>\r\n                      <PlusOutlined />\r\n                      <div style={{marginTop: '8px'}}>上传证件照</div>\r\n                  </div>\r\n              </span>\r\n          </div>\r\n          }\r\n        </div>\r\n\r\n        </>\r\n    )\r\n})\r\n\r\nSingleUpload.defaultProps = {\r\n    multiple: false,\r\n    disable: false\r\n}\r\n\r\nexport default SingleUpload\r\n","export { default as SingleUpload } from './SingleUpload'\r\nexport { default as AvatarUpload } from './AvatarUpload'\r\n\r\n\r\n","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".singleUpload {\\n  width: 128px;\\n  height: 128px;\\n  margin-right: 8px;\\n  margin-bottom: 8px;\\n  text-align: center;\\n  vertical-align: top;\\n  background-color: #fafafa;\\n  border: 1px dashed #d9d9d9;\\n  border-radius: 2px;\\n  cursor: pointer;\\n  -webkit-transition: border-color .3s;\\n  transition: border-color .3s; }\\n\\n.upload-select {\\n  width: 104px;\\n  height: 104px;\\n  margin-right: 8px;\\n  margin-bottom: 8px;\\n  text-align: center;\\n  vertical-align: top;\\n  background-color: #fafafa;\\n  border: 1px dashed #d9d9d9;\\n  border-radius: 2px;\\n  -webkit-transition: border-color .3s;\\n  transition: border-color .3s;\\n  cursor: pointer; }\\n\\n.upload-list {\\n  -webkit-box-sizing: border-box;\\n  box-sizing: border-box;\\n  margin: 0;\\n  padding: 0;\\n  color: rgba(0, 0, 0, 0.85);\\n  font-size: 14px;\\n  font-variant: tabular-nums;\\n  list-style: none;\\n  -webkit-font-feature-settings: \\\"tnum\\\";\\n  font-feature-settings: \\\"tnum\\\";\\n  line-height: 1.5715; }\\n\\n.upload-list-item {\\n  display: inline-block;\\n  width: 104px;\\n  height: 134px;\\n  margin: 0 8px 8px 0;\\n  vertical-align: top; }\\n  .upload-list-item-info {\\n    display: inline-block;\\n    width: 104px;\\n    height: 104px;\\n    overflow: hidden;\\n    border: 1px solid #c9c9c9; }\\n    .upload-list-item-info img {\\n      width: 100%;\\n      height: 100%;\\n      -o-object-fit: scale-down;\\n      object-fit: scale-down; }\\n  .upload-list-item-actions {\\n    text-align: center; }\\n\\n.upload {\\n  overflow: hidden;\\n  position: relative;\\n  outline: 0;\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-align: center;\\n  -ms-flex-align: center;\\n  align-items: center;\\n  -webkit-box-pack: center;\\n  -ms-flex-pack: center;\\n  justify-content: center;\\n  height: 100%;\\n  text-align: center; }\\n  .upload input {\\n    position: absolute;\\n    top: -29px;\\n    left: -10px;\\n    width: 120%;\\n    height: 150%;\\n    overflow: hidden;\\n    cursor: pointer;\\n    opacity: 0; }\\n\\n.avatar-upload {\\n  position: relative;\\n  width: 150px;\\n  height: 200px;\\n  border-radius: 10px;\\n  overflow: hidden; }\\n  .avatar-upload .upload-list-item {\\n    width: 150px;\\n    height: 200px; }\\n  .avatar-upload .upload-list-item-info {\\n    display: inline-block;\\n    width: 150px;\\n    height: 200px;\\n    overflow: hidden;\\n    border: none;\\n    background: #e9e9e9; }\\n  .avatar-upload .avatar-upload-select {\\n    position: absolute;\\n    width: 100%;\\n    height: 100%;\\n    top: 0;\\n    left: 0;\\n    opacity: 0; }\\n\", \"\"]);\n\n","\r\nimport { request } from '@/utils/api.request'\r\n\r\n/**-------------------------------安置------------------------------- */\r\n// 删除安置信息\r\nexport const deletePlace = (id:string) => request.get(`/placeInfo/deletePlace?id=${id}`)\r\n\r\n// 批量删除安置信息\r\nexport const deletePlaces = (ids:string) => request.get(`/placeInfo/deletePlaces?ids=${ids}`)\r\n\r\n// 根据安置id查询安置信息\r\nexport const getPlace = (id:string) => request.get(`/placeInfo/getPlace?id=${id}`)\r\n\r\n// 查询安置信息列表\r\nexport const getPlacePage = (data:any) => request.post('/placeInfo/getPlacePage', data)\r\n\r\n// 新增/修改安置信息\r\nexport const savePlace = (data:any) => request.post('/placeInfo/savePlace', data)","import React, { useState, useEffect, forwardRef, useRef, useImperativeHandle, useContext} from 'react'\r\nimport { CustSchemaForm } from '@/components/form'\r\nimport { FormInstance } from 'antd/lib/form'\r\nimport {getOrganizationTtree, getDictionaryOption} from '@/api/system'\r\nimport { mapTree } from '@/utils/index'\r\nimport {SingleUpload} from '@/components/upload'\r\nimport {Context} from './allDetail'\r\n\r\nconst FormInfoPage = forwardRef<any>((props, ref) => {\r\n    const getContext = useContext(Context) // 接收创建的context\r\n    const { modalType, resData, fileList, veteransId} = getContext\r\n\r\n    // const placeInfoData = useSelector((state:RootState) => state.placeInfoReducer)\r\n    const formRef =  useRef<FormInstance>(null)\r\n    const uploadRef = useRef<any>(null)\r\n    // const {} = resData ? resData:{fileList:[], veteransId:null}\r\n    // useEffect(()=>{\r\n    //     console.log('placeInfoData', placeInfoData)\r\n    //     let isUnmount = false;      //这里插入isUnmount\r\n    //     const fetchDetail = async () => {\r\n    //         const {code, result}:any = await getOrganizationTtree() \r\n    //       if (code == '200' && !isUnmount) {  //加上判断isUnmount才去更新数据渲染组件\r\n    //         let arr = mapTree(result[0])['children']\r\n    //         console.log('arr', arr)\r\n    //         setState({organizationIdOtions:arr.length > 0? arr:[]});\r\n    //       }\r\n    //     }\r\n    //     fetchDetail()\r\n    //     return () => (isUnmount = true) as any\r\n    // },[])\r\n\r\n    const addSchema = {\r\n        layout : {\r\n            labelCol: { span: 8 },\r\n            wrapperCol: { span: 12 },\r\n        },\r\n        grid: {\r\n            rowGutter: 10,\r\n            colSpan: 12\r\n        },\r\n        formItem: [\r\n            {\r\n                type:\"title\",\r\n                title:\"个人基本信息\"\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"名称\",\r\n                field: \"name\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入名称\"\r\n                },\r\n                // rules: [\r\n                //     {\r\n                //         required: true,\r\n                //         message: \"名称不能为空\"\r\n                //     }\r\n                // ]\r\n            },\r\n            {\r\n                type: \"tree-select\",\r\n                label: \"行政区域\",\r\n                field: \"organizationId\",\r\n                value: undefined,\r\n                loading: true,\r\n                props: {\r\n                    placeholder: \"请选择单位\",\r\n                    treeDefaultExpandAll: false,\r\n                },\r\n                asyncOptions: async (curValue:any, fields:any) => {\r\n                    const {result}:any = await getOrganizationTtree() \r\n                    let arr = mapTree(result[0])\r\n                    return arr? [arr]:[]\r\n                }\r\n            },\r\n            {\r\n                type: \"radio\",\r\n                label: \"性别\",\r\n                field: \"sex\",\r\n                value: '',\r\n                options:[\r\n                    {value:'M', label:'男'},\r\n                    {value:'F', label:'女'}\r\n                ],\r\n                // rules: [\r\n                //     {\r\n                //         required: true,\r\n                //         message: \"性别不能为空\"\r\n                //     }\r\n                // ]\r\n            },\r\n            {\r\n                type: \"select\",\r\n                label: \"民族\",\r\n                field: \"nation\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入民族\"\r\n                },\r\n                asyncOptions: async () => {\r\n                    const result = await getDictionaryOption('300029')\r\n                    return result  \r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"曾用名\",\r\n                field: \"nameUsedBefore\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入曾用名\"\r\n                }\r\n            },\r\n            {\r\n                type: \"radio\",\r\n                label: \"委托代办\",\r\n                field: \"agentOrNot\",\r\n                value: '',\r\n                options:[\r\n                    {value:'0', label:'是'},\r\n                    {value:'1', label:'否'}\r\n                ]\r\n            },\r\n            {\r\n                type: \"date-pcker\",\r\n                label: \"出生日期\",\r\n                field: \"birthDate\",\r\n                value: \"2020-12-29 09:23:14\",\r\n                props: {\r\n                    placeholder: \"请选择出生日期\"\r\n                }\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"身份证号\",\r\n                field: \"idCardNo\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入身份证号\"\r\n                },\r\n                // rules: [\r\n                //     {\r\n                //         required: true,\r\n                //         message: \"身份证号不能为空\"\r\n                //     }\r\n                // ]\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"户籍地\",\r\n                field: \"domicile\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入户籍地\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"签发机关\",\r\n                field: \"signingIssuingOrganization\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入签发机关\"\r\n                },\r\n            },\r\n            {\r\n                type: \"date-pcker\",\r\n                label: \"有效期\",\r\n                field: \"termValidityEnd\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请选择有效期\"\r\n                }\r\n            },\r\n            {\r\n                type: \"select\",\r\n                label: \"文化程度\",\r\n                field: \"educationDegree\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"文化程度\"\r\n                },\r\n                asyncOptions: async () => {\r\n                    const result = await getDictionaryOption('300028')\r\n                    return result  \r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"实际居住地址\",\r\n                field: \"actualAddress\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入实际居住地址\"\r\n                },\r\n            },\r\n            {\r\n                type: \"select\",\r\n                label: \"户口类型\",\r\n                field: \"householdType\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请选择户口类别\"\r\n                },\r\n                asyncOptions: async () => {\r\n                    const result = await getDictionaryOption('300031')\r\n                    return result  \r\n                },\r\n            },\r\n            {\r\n                type: \"select\",\r\n                label: \"婚姻状况\",\r\n                field: \"maritalStatus\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请选择婚姻状况\"\r\n                },\r\n                asyncOptions: async () => {\r\n                    const result = await getDictionaryOption('300030')\r\n                    return result  \r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"固定电话\",\r\n                field: \"fixedTelephone\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入固定电话\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"联系电话\",\r\n                field: \"phone\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入联系电话\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"微信或者qq\",\r\n                field: \"wechatQq\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入微信或者qq\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"备注\",\r\n                field: \"remarks\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入备注\"\r\n                },\r\n            },\r\n            // {\r\n            //     type: \"input\",\r\n            //     label: \"附件\",\r\n            //     field: \"fileIds\",\r\n            //     value: \"\",\r\n            //     props: {\r\n            //         placeholder: \"请输入附件\"\r\n            //     },\r\n            // },\r\n            {\r\n                type: \"slot\",\r\n                label: \"附件\",\r\n                field: \"fileIds\",\r\n                grid: {\r\n                    rowGutter: 0,\r\n                    colSpan: 24\r\n                },\r\n                tailLayout:{\r\n                    labelCol: { span: 4 },\r\n                    wrapperCol: { span: 20 },\r\n                }, \r\n                render(){\r\n                    return <SingleUpload ref={uploadRef} ownerId={veteransId} fileList={fileList} disable={modalType === 'detail'? true:false}/>\r\n                }\r\n            },\r\n            {\r\n                type:\"title\",\r\n                title:\"类别信息\"\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"人员类型\",\r\n                field: \"personnelType\",\r\n                value: \"\",\r\n                grid: {\r\n                    rowGutter: 0,\r\n                    colSpan: 24\r\n                },\r\n                tailLayout:{\r\n                    labelCol: { span: 4 },\r\n                    wrapperCol: { span: 20 },\r\n                }, \r\n                options:[\r\n                    { label: '军队转业干部', value: '1' },\r\n                    { label: '退役士兵', value: '2' },\r\n                    { label: '军队离退休干部和退休士官', value: '3' },\r\n                    { label: '军队无军籍离退休退职职工', value: '4' },\r\n                    { label: '退伍红军老战士', value: '5' },\r\n                    { label: '复员军人', value: '6' },\r\n                    { label: '残疾军人', value: '7' },\r\n                    { label: '伤残民兵民工', value: '8' },\r\n                    { label: '烈士遗属', value: '9' },\r\n                    { label: '因公牺牲军人遗属', value: '10' },\r\n                    { label: '病故军人遗属', value: '11' },\r\n                    { label: '现役军人家属', value: '12' }\r\n                ]\r\n            },\r\n            {\r\n                type:\"title\",\r\n                title:\"生活状况\"\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"个人年收入(元)\",\r\n                field: \"personAnnualIncome\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入个人年收入\"\r\n                },\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"医疗保险\",\r\n                field: \"medicalInsurance\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '城乡居民基本医疗保险', value: '1' },\r\n                    { label: '职工基本医疗保险', value: '2' },\r\n                    { label: '公费医疗', value: '3' },\r\n                    { label: '无', value: '4' }\r\n                ]\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"养老保险\",\r\n                field: \"pensionBenefits\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '城乡居民社会养老保险', value: '1' },\r\n                    { label: '职工基本养老保险', value: '2' },\r\n                    { label: '离退休金', value: '3' },\r\n                    { label: '无', value: '4' }\r\n                ]\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"住房公积金\",\r\n                field: \"housingFunds\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入住房公积金\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"享受国家抚恤补助金情况\",\r\n                field: \"statePension\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入享受国家抚恤补助金情况\"\r\n                },\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"享受残废人两项补贴\",\r\n                field: \"disabledWelfare\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入享受残废人两项补贴\"\r\n                },\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"住房状况\",\r\n                field: \"houseType\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '无', value: '1' },\r\n                    { label: '自建房', value: '2' },\r\n                    { label: '公有住房', value: '3' },\r\n                    { label: '经济适用房', value: '4' },\r\n                    { label: '公租房', value: '5' },\r\n                    { label: '廉租房', value: '6' },\r\n                    { label: '商品房', value: '7' },\r\n                    { label: '还建房', value: '8' },\r\n                    { label: '其它', value: '9' }\r\n                ]\r\n            },\r\n            {\r\n                type: \"select\",\r\n                label: \"社会救助状况\",\r\n                field: \"socialAssistance\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '低保', value: '1' },\r\n                    { label: '五保', value: '2' },\r\n                    { label: '建档立卡贫困户', value: '3' },\r\n                    { label: '无', value: '4' }\r\n                ]\r\n            },\r\n            {\r\n                type:\"title\",\r\n                title:\"其它情况\"\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"主要困难\",\r\n                field: \"mainDifficulties\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '就业', value: '3' },\r\n                    { label: '生活', value: '4' },\r\n                    { label: '住房', value: '5' },\r\n                    { label: '医疗', value: '6' },\r\n                    { label: '养老', value: '7' },\r\n                    { label: '教育', value: '8' },\r\n                    { label: '其它', value: '9' }\r\n                ]\r\n            },\r\n            {\r\n                type: \"checkbox\",\r\n                label: \"主要诉求\",\r\n                field: \"mainDemands\",\r\n                value: \"\",\r\n                options:[\r\n                    { label: '提高待遇问题', value: '1' },\r\n                    { label: '确认身份问题', value: '2' },\r\n                    { label: '安排工作问题', value: '3' },\r\n                    { label: '解决三难问题', value: '4' },\r\n                    { label: '解决社保问题', value: '5' },\r\n                    { label: '其它', value: '6' }\r\n                ]\r\n            },\r\n            {\r\n                type: \"input\",\r\n                label: \"具体诉求(不超过500字)\",\r\n                field: \"specificDemands\",\r\n                value: \"\",\r\n                props: {\r\n                    placeholder: \"请输入具体诉求\"\r\n                },\r\n            },\r\n        //   {\r\n        //     type: \"slot\",\r\n        //     field: \"priority\",\r\n        //     render:()=>{\r\n        //         return <span style={{width:'100%', height:'300px'}}>dddd</span>\r\n        //     }\r\n        //   },\r\n        ]\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const [validateForm, setValidateForm] = useState(addSchema)\r\n\r\n    const [fields, setFields] = useState(null as any)\r\n\r\n    useEffect(()=>{\r\n        console.log('modalType=====》', modalType)\r\n        if(resData) setFields(resData.veteransBaseInfo)\r\n    }, [])\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        // getfileIds: () => {\r\n        //     return (uploadRef as any).current.getIds() || []\r\n        // },\r\n        ...uploadRef.current,\r\n        ...formRef.current\r\n    }));\r\n\r\n    return (\r\n        <>\r\n            <CustSchemaForm ref={formRef} fields={fields} dynamicValidateForm={validateForm} modalType={modalType}/>\r\n        </>\r\n    )\r\n})\r\n\r\nexport default FormInfoPage","import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle} from 'react'\r\nimport { Button, message as Message, Space } from 'antd'\r\nimport FormInfo from './formInfo'\r\nimport { FormInstance } from 'antd/lib/form'\r\nimport {savePlace, getPlace} from '@/api/placeInfo'\r\nimport {formatToDateTime} from '@/utils/dateUtil'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport moment from 'moment'\r\nimport { matchPath } from 'react-router'\r\nimport { RootState } from '@/store/types'\r\nimport { setPanes } from '@/store/actions'\r\nimport { Spin } from 'antd'\r\n\r\ninterface DetailProps {\r\n  modalType?:string\r\n}\r\n\r\n// 创建一个context，默认值是edit\r\nexport const Context = React.createContext({modalType:'edit'} as any)\r\n\r\nconst DetailPage = forwardRef<any, DetailProps>((props, ref) => {\r\n    const {modalType} = props\r\n    const history = useHistory()\r\n    const location = useLocation()\r\n    const  {state} = location\r\n\r\n    const panes = useSelector((state:RootState) => state.layoutReducer.panes)\r\n    const dispatch = useDispatch()\r\n\r\n    const [isLoading, setLoading] =useState(false)\r\n\r\n    const [size, setSize] = useState()\r\n    const [detailType, setType]= useState(modalType)\r\n    const [resData, setResult] = useState()\r\n    const [fileList, setFileList] =useState([])\r\n    const [veteransId, setVeteransId] =useState('')\r\n    const _isCancelled = useRef(false)\r\n\r\n    const formRef = useRef<FormInstance>(null)\r\n\r\n    const deletePane=(url:string)=>{\r\n      const index = panes.findIndex((item:any)=> {\r\n          return item.menuPath === url\r\n      })\r\n      if(index > 0){\r\n          const arr = panes\r\n          arr.splice(index, 1)\r\n          dispatch(setPanes([...arr]))\r\n      }\r\n    }\r\n\r\n    const getDetail=async(placeId:string)=>{\r\n        setLoading(true)\r\n        const {result, code}:any = await getPlace(placeId)\r\n        if(code === 200 && !_isCancelled.current){\r\n          // dispatch(SetPlaceInfo(result))\r\n          console.log('ssssssss', formRef)\r\n          setResult(result)\r\n          setFileList(result.fileList)\r\n          setVeteransId(result.veteransId)\r\n          // console.log('veteransId', result.veteransId)\r\n          const {birthDate, termValidityEnd, termValidityStart} = result.veteransBaseInfo\r\n          formRef.current && formRef.current!.setFieldsValue({\r\n            ...result,\r\n            ...result.veteransBaseInfo,\r\n            birthDate: birthDate ? moment(birthDate) : null,\r\n            termValidityEnd: termValidityEnd ? moment(termValidityEnd) : null,\r\n            termValidityStart: termValidityStart ? moment(termValidityStart) : null,\r\n          })\r\n          formRef.current && (formRef as any).current.setfileList(result.fileList)\r\n        }\r\n        setLoading(false)\r\n    }\r\n\r\n    const checkUrls = () =>{\r\n      let url = location.pathname.split('/').slice(0, 3).join('/')\r\n      let aUrl = matchPath(location.pathname, {path: `${url}/:id`, exact: true})\r\n      return aUrl\r\n    }\r\n\r\n    const getDatas=()=>{\r\n      const a:any = checkUrls()\r\n      console.log('a' , a)\r\n      if(a && a.params!.id){\r\n        getDetail(a.params!.id)\r\n      }\r\n    }\r\n\r\n    useEffect(()=>{\r\n      return ()=>{\r\n        _isCancelled.current = true\r\n      }\r\n    }, [])\r\n\r\n    useEffect(()=>{\r\n      if(state && (state as any).refresh){\r\n        getDatas() \r\n      }\r\n    }, [state])\r\n\r\n    const handleClose=()=>{\r\n      deletePane(location.pathname)\r\n      history.push({\r\n        pathname:'/placeInfo',\r\n        state:{\r\n          refresh: true\r\n        }\r\n      })\r\n    }\r\n  \r\n    const handleSubmit= async(state:string)=>{\r\n      try {\r\n        const data =  formRef.current && await formRef.current!.validateFields() \r\n        const {actualAddress, domicile, educationDegree, fixedTelephone, health, householdAddress, householdAddressType, householdType,\r\n          idCardNo, idPhoto, maritalStatus, name, nameUsedBefore, nation, organizationId,\r\n          phone, politicalIdentity, remarks, sex, signingIssuingOrganization, veteransId, wechatQq, whetherHk,\r\n          birthDate, termValidityEnd, termValidityStart, fileIds, \r\n          houseType, mainDemands, mainDifficulties, medicalInsurance, pensionBenefits, personnelType, ...rest\r\n        } = data\r\n        const params={\r\n          placeId: detailType === 'edit'? (resData as any).placeId : null,\r\n          version: detailType === 'edit'? (resData as any).version : null,\r\n          veteransId:  detailType === 'edit'? veteransId : null,\r\n          type: detailType === 'edit'? (resData as any).type : null,\r\n          // fileIds:[\"96436ed2289eebd9e9b41893672c5c6f\", \"46c04891aa0ae8e6075628f1239d0e3f\"],\r\n          fileIds: (formRef as any).current.getfileIds(),\r\n          houseType: houseType.toString(),\r\n          mainDemands: mainDemands.toString(),\r\n          mainDifficulties: mainDifficulties.toString(),\r\n          medicalInsurance: medicalInsurance.toString(),\r\n          pensionBenefits: pensionBenefits.toString(),\r\n          personnelType: personnelType.toString(),\r\n          state,\r\n          // \"agentOrNot\": \"string\",\r\n          // \"disabledWelfare\": \"string\",\r\n          // \"fileIds\": [\"string\"],\r\n          // \"houseType\": \"string\",\r\n          // \"housingFunds\": \"string\",\r\n          // \"mainDemands\": \"string\",\r\n          // \"mainDifficulties\": \"string\",\r\n          // \"medicalInsurance\": \"string\",\r\n          // \"pensionBenefits\": \"string\",\r\n          // \"personAnnualIncome\": \"string\",\r\n          // \"personnelType\": \"string\",\r\n          // \"socialAssistance\": \"string\",\r\n          // \"specificDemands\": \"string\",\r\n          // \"state\": state,\r\n          // \"statePension\": \"string\",\r\n          // \"type\": \"string\",\r\n          // \"version\": 0,\r\n          ...rest,\r\n          veteransBaseInfoAddReq: {\r\n            veteransId: detailType === 'edit'? veteransId : null,\r\n            version: detailType === 'edit'? (resData as any).veteransBaseInfo.version : null,\r\n            actualAddress,\r\n            birthDate: birthDate?formatToDateTime(birthDate):null,\r\n            domicile,\r\n            educationDegree,\r\n            fixedTelephone,\r\n            health,\r\n            householdAddress,\r\n            householdAddressType,\r\n            householdType,\r\n            idCardNo,\r\n            idPhoto,\r\n            maritalStatus,\r\n            name,\r\n            nameUsedBefore,\r\n            nation,\r\n            organizationId,\r\n            phone,\r\n            politicalIdentity,\r\n            remarks,\r\n            sex,\r\n            signingIssuingOrganization,  \r\n            \"termValidityEnd\": termValidityEnd?formatToDateTime(termValidityEnd):null,\r\n            \"termValidityStart\": termValidityStart?formatToDateTime(termValidityStart):null,\r\n            wechatQq,\r\n            whetherHk,\r\n          }\r\n        }\r\n\r\n        const {code}:any = await savePlace(params) \r\n        if(code===200){\r\n          Message.success('操作成功')\r\n          handleClose()\r\n        }\r\n\r\n      } catch(err) {\r\n        console.log(err)\r\n      } \r\n    }\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      resData:resData?resData:{},\r\n      close:handleClose,\r\n      forceUpdate:getDatas\r\n    }))\r\n\r\n    return ( \r\n      <Context.Provider value={{modalType: detailType, resData:resData, fileList:resData?(resData as any).fileList:[], veteransId:resData?(resData as any).veteransId:null}}>\r\n        <div className=\"content form-content\">\r\n        <Spin spinning={isLoading}>\r\n          <FormInfo ref={formRef} />\r\n          {detailType!=='detail'?\r\n            <div className=\"form-footer center\">\r\n              <Space>\r\n                <Button type=\"primary\" onClick={()=>handleSubmit('0')}>\r\n                  保存\r\n                </Button>\r\n                <Button type=\"primary\" onClick={()=>handleSubmit('1')}>\r\n                  提交\r\n                </Button>\r\n                <Button onClick={handleClose}>\r\n                  关闭\r\n                </Button>\r\n              </Space>\r\n            </div>:''\r\n          }\r\n          </Spin>\r\n        </div>\r\n     </Context.Provider>\r\n  )\r\n})\r\n\r\nexport default DetailPage"],"sourceRoot":""}